# Post-Exploitation

> #### ⚡ Prerequisites
>
> * Basic familiarity with Linux & Windows
> * Basic understanding of TCP & UDP protocols
> * Basic familiarity with Metasploit and Exploitation
>
> #### 📕 Learning Objectives
>
> * Perform **post exploitation**
> * Perform Win/Linux **local enumeration**
> * Upgrade **shells** and **elevate privileges**
> * Establish **persistence** and **dump** account **hashes**
> * **Pivot** to other systems and **clear** tracks
>
> #### 🔬 Training list - PentesterAcademy/INE Labs
>
> `subscription required`
>
> - [Linux Privilege Escalation](https://www.attackdefense.com/listing?labtype=linux-security-priv-esc&subtype=linux-security-priv-esc-basic)
> - [Windows Privilege Escalation](https://www.attackdefense.com/listing?labtype=windows-priv-esc&subtype=windows-priv-esc-basic)
> - [Linux Pivoting](https://www.attackdefense.com/listing?labtype=linux-security-pivoting&subtype=linux-security-pivoting-getting-started)
> - [Linux Persistence](https://www.attackdefense.com/listing?labtype=linux-security-maintain-access&subtype=linux-security-maintain-access-getting-started)
> - [Windows Persistence](https://www.attackdefense.com/listing?labtype=windows-maintaining-access&subtype=windows-maintaining-access-basics)
>

## [Post-Exploitation](http://www.pentest-standard.org/index.php/Post_Exploitation) Introduction

🗒️ **Post-Exploitation** is the final phase of interaction with a target during a pentest. Using various attacking techniques, the pentester determines the value of the compromised system and keeps control of it for future usage, depending on the kind of access and the stealthiness he must have.

It is *what the pentester does after the initial foothold* and the techniques depends on the target characteristics (operating system, infrastructure).

- The techniques must follow the ***Rules of Engagement*** agreed upon with the client **before the penetration test**, based on the company infrastructure and services.

> ❗**Necessary permissions are required to conduct post-exploitation techniques like modifying services, system configuration, logs deletion, perform privilege escalation.**

### Methodology

1. Local Enumeration
2. Transferring Files
3. Upgrading Shells
4. Privilege Escalation
5. Persistence
6. Dumping & Cracking Hashes
7. Pivoting
8. Clearing Tracks

*The post-exploitation process repeats itself after pivoting to another new target.*

> 🔬 The following techniques are covered in the
>
> * 🪟 [Windows Post-Exploitation Labs](5-post-exploit/win-post-exp.md)
> * 🐧 [Linux Post-Exploitation Labs](5-post-exploit/linux-post-exp.md)

## Windows Local Enumeration

> 📝📌 [Checklist - Local Windows Privilege Escalation | HackTricks](https://book.hacktricks.xyz/windows-hardening/checklist-windows-privilege-escalation)
>
> 🔬 [Windows Post-Exploitation Lab](5-post-exploit/win-post-exp.md)

### System Information

*What is running on the target system?*

- Hostname
- OS Name, Build, Service Pack, Architecture
- Installed updates/Hotfixes

### Users & Groups

- Current user, privileges & additional user information
- Other users
- Groups
- Members of the built-in administrators group

### Network information & Services

- IP address & network adapter
- Internal networks and other hosts on the network
- TCP/UDP services + ports
- Routing table
- Windows Firewall state
- Running processes & services
- Scheduled tasks

A **process** is an istance of a running program.

A **service** is a process that runs in the background.

### Automating Local Enumeration

The Local Enumeration process can be automated with the help of scripts and Metasploit Framework modules.

- Be time efficient
- Additional enumeration & exploitation information

**Tools**:

- [JAWS - Just Another Windows (Enum) Script](https://github.com/411Hall/JAWS)
- [winPEAS](https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS)

## Linux Local Enumeration

> 📝📌 [Checklist - Linux Privilege Escalation | HackTricks](https://book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist)
>
> 🔬 [Linux Post-Exploitation Lab](5-post-exploit/linux-post-exp.md)

### System Information

- Hostname
- Distribution & release version
- Kernel version & Architecture
- CPU information
- Disk & mounted drives
- Installed packages

### Users & Groups

- Current user & privileges
- Other users
- Groups

### Network information & Services

- IP address & network adapter
- Internal networks and other hosts on the network
- TCP/UDP services + ports
- Running services
- Scheduled Cron Jobs

### Automating Local Enumeration

The Local Enumeration process can be automated with the help of scripts and Metasploit Framework modules. It is very useful to be time efficient.

**Tools**:

- [LinEnum - rebootuser](https://github.com/rebootuser/LinEnum)
- [linPEAS](https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS)

## Transferring Files

### Python Web Server

### Transferring Files



## Shells

### Upgrade To Meterpreter

### Spawn TTY Shells



## Windows Privilege Escalation





## Linux Privilege Escalation





## Windows Persistence





## Linux Persistence





## Dumping & Cracking Hashes





## Pivoting

### Internal Network Recon



### Pivot



## Clearing Tracks

### Windows

### Linux